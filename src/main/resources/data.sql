BEGIN;
CREATE TABLE admin (
    admin_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email VARCHAR(255) NOT NULL,
    password VARCHAR(255) NOT NULL
);

CREATE TABLE booking (
    booking_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    arrivalDate DATE NOT NULL,
    departureDate DATE NOT NULL,
    arrivalHour TIME,
    isLateDeparture BOOLEAN,
    reservationStatus VARCHAR(20),
    paymentStatus VARCHAR(20),
    amountPaid DECIMAL(10, 2) NOT NULL,
    adultNumber INT NOT NULL,
    couplesAmongAdults INT NOT NULL,
    childNumber INT NOT NULL,
    babyNumber INT NOT NULL,
    animalType VARCHAR(255)[],
    animalNote TEXT,
    breakfastNumber INT NOT NULL,
    lunchNumber INT NOT NULL,
    dinerNumber INT NOT NULL,
    guestNote TEXT,
    adminNote TEXT
);

CREATE TABLE client (
    client_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    firstName VARCHAR(100) NOT NULL,
    lastName VARCHAR(100) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    phoneNumber VARCHAR(20),
    addressFirstLine VARCHAR(255) NOT NULL,
    addressComplement VARCHAR(255),
    addressZipCode VARCHAR(20),
    addressCity VARCHAR(100),
    addressCountry VARCHAR(100)
);

CREATE TABLE guest_room (
    guest_room_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    surfaceArea DECIMAL(10, 2) NOT NULL,
    roomType VARCHAR(50) NOT NULL,
    pictures TEXT[],  -- Array of text strings for pictures
    singleBedNumber INT NOT NULL,
    childBedNumber INT NOT NULL,
    babyBedNumber INT NOT NULL,
    equipment TEXT[],  -- Array of text strings for equipment
    pricePerNight DECIMAL(10, 2) NOT NULL,
    disponibility BOOLEAN NOT NULL,  -- Use BOOLEAN for availability status
    touristTax INT NOT NULL,
    additionnalTax DECIMAL(10, 2) NOT NULL
);

CREATE TABLE booking_guest_room (
    booking_id BIGINT REFERENCES booking(booking_id) ON DELETE CASCADE,
    guest_room_id BIGINT REFERENCES guest_room(guest_room_id) ON DELETE CASCADE,
    PRIMARY KEY (booking_id, guest_room_id)
);

CREATE TABLE booking_guest_rooms_ids (
    booking_id BIGINT REFERENCES booking(booking_id) ON DELETE CASCADE,
    guest_room_id BIGINT REFERENCES guest_room(guest_room_id) ON DELETE CASCADE,
    PRIMARY KEY (booking_id, guest_room_id)
);

CREATE TABLE guest_room_bookings (
    booking_id BIGINT REFERENCES booking(booking_id) ON DELETE CASCADE,
    guest_room_id BIGINT REFERENCES guest_room(guest_room_id) ON DELETE CASCADE,
    PRIMARY KEY (booking_id, guest_room_id)
);

INSERT INTO admin (admin_id, email, password) VALUES (1, 'toto@test.fr', '1234');

-- INSERT INTO guest_room (
--     name, 
--     description, 
--     surfaceArea, 
--     roomType, 
--     pictures, 
--     singleBedNumber, 
--     childBedNumber, 
--     babyBedNumber, 
--     equipment, 
--     pricePerNight, 
--     disponibility, 
--     touristTax, 
--     additionnalTax
-- ) VALUES (
--     'Chambre aubépine', 
--     'Bienvenue dans la Chambre Aubépine, où la sérénité des fleurs d’aubépine crée une atmosphère douce et accueillante. Comme un chevreuil flânant sous les branches fleuries, vous vous laisserez envoûter par les délicates fleurs blanches qui embaument l'air au printemps, apportant une touche de fraîcheur et de tranquillité. Ici, sous l'influence apaisante de ces arbres, vous pourrez vous détendre dans un environnement où les meubles en bois aux boiseries élégamment travaillées et les murs dans des tons blancs et bleu ciel créent une atmosphère campagnarde raffinée. La cheminée en marbre ajoute une touche de sophistication, tout en préservant le charme simple et naturel de cette chambre inspirée par les aubépines.', 
--     90.00, 
--     'FARM_ROOM', 
--     '{"picture1.jpg", "picture2.jpg"}',  -- Array of picture filenames
--     1, 
--     1, 
--     1, 
--     '{"TV", "Minibar", "Air Conditioning"}',  -- Array of equipment
--     200.00, 
--     TRUE, 
--     10, 
--     25.00
-- );

COMMIT;

-- For now doesn't work, necesity to add data manually